import{_ as j}from"./rjtqedRv.js";import{g as H,r as u,j as Y,c as R,o as V,n as w,a as S,b as k,w as b,d as E,_ as q}from"./CO2j4tte.js";const L=10,O=10,G=1e3,P=2e3,J=H({__name:"mosaic",props:{images:{}},setup(x){const a=u(null),M=u(null),F=u(null),h=x,I=u(0),o=u(null),g=u(null),$=u(!1),C=s=>new Promise(e=>{const n=new Image;n.onload=()=>e(n),n.src=s}),U=async()=>{var s;a.value&&(o.value=a.value.getContext("2d"),g.value=await C(h.images[I.value]),(s=o.value)==null||s.drawImage(g.value,0,0,a.value.width,a.value.height))},A=(s,e,n)=>{if(!a.value)return[];const i=a.value.width/n,B=a.value.height/e,_=[];for(let r=0;r<e;r++)for(let d=0;d<n;d++){const f=d*s.width/n,p=r*s.height/e,l=s.width/n,v=s.height/e,t=d*i,m=r*B,c=i,y=B;_.push({sx:f,sy:p,sw:l,sh:v,dx:t,dy:m,dw:c,dh:y})}return _},W=async s=>{if($.value||!g.value)return;$.value=!0;const e=g.value,n=await C(h.images[s]),i=A(e,L,O),_=[...A(n,L,O)].sort(()=>Math.random()-.5),r=[];for(let l=0;l<i.length;l++){const v=i[l],t=_[l],m=Math.random()*G;r.push({s:v,t,delay:m})}const d=P+Math.max(...r.map(l=>l.delay),0);let f=null;const p=l=>{if(!o.value||!a.value)return;f||(f=l);const v=l-f;if(v>=d){o.value.drawImage(n,0,0,a.value.width,a.value.height),g.value=n,I.value=s,$.value=!1;return}o.value.clearRect(0,0,a.value.width,a.value.height);for(const t of r){const m=v-t.delay;let c=0;m>0&&(c=Math.min(1,m/P));const y=t.s.dx+(t.t.dx-t.s.dx)*c,D=t.s.dy+(t.t.dy-t.s.dy)*c,z=t.s.dw+(t.t.dw-t.s.dw)*c,N=t.s.dh+(t.t.dh-t.s.dh)*c;o.value.save(),o.value.globalAlpha=1-c,o.value.drawImage(e,t.s.sx,t.s.sy,t.s.sw,t.s.sh,y,D,z,N),o.value.globalAlpha=c,o.value.drawImage(n,t.t.sx,t.t.sy,t.t.sw,t.t.sh,y,D,z,N),o.value.restore()}requestAnimationFrame(p)};requestAnimationFrame(p)},T=s=>{const e=s==="next"?1:-1,n=(I.value+e+h.images.length)%h.images.length;W(n)};return Y(()=>{U()}),(s,e)=>{const n=j;return V(),R("div",{class:w(s.$style.SliderMosaic)},[S("canvas",{ref_key:"canvas",ref:a,width:"768",height:"512",class:w(s.$style.canvas)},null,2),S("div",{class:w(s.$style.controls)},[k(n,{ref_key:"prevBtn",ref:M,onClick:e[0]||(e[0]=i=>T("prev"))},{default:b(()=>e[2]||(e[2]=[E(" ⟵ ")])),_:1},512),k(n,{ref_key:"nextBtn",ref:F,onClick:e[1]||(e[1]=i=>T("next"))},{default:b(()=>e[3]||(e[3]=[E(" ⟶ ")])),_:1},512)],2)],2)}}}),K="_SliderMosaic_14zwy_8",Q="_canvas_14zwy_14",X="_controls_14zwy_21",Z={SliderMosaic:K,canvas:Q,controls:X},tt={$style:Z},et=q(J,[["__cssModules",tt]]),st={},nt={},at={class:"container"};function ot(x,a){const M=et;return V(),R("div",{class:w([x.$style.SliderPage,"page"])},[S("div",at,[k(M,{images:["../img/catDefault1.png","../img/catDefault2.png","../img/catDefault3.png"]})])],2)}const lt={$style:st},it=q(nt,[["render",ot],["__cssModules",lt]]);export{it as default};
